<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[Python] Automation - 1. GUI" /><meta property="og:locale" content="en" /><meta name="description" content="‘자동화’라는 것을 해보자. Python으로 하고 window 운영체제 한정이다." /><meta property="og:description" content="‘자동화’라는 것을 해보자. Python으로 하고 window 운영체제 한정이다." /><link rel="canonical" href="https://ch-hey.github.io/posts/python-automation-gui/" /><meta property="og:url" content="https://ch-hey.github.io/posts/python-automation-gui/" /><meta property="og:site_name" content="ChBlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-19T19:55:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Python] Automation - 1. GUI" /><meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-19T19:55:00+08:00","datePublished":"2022-10-19T19:55:00+08:00","description":"‘자동화’라는 것을 해보자. Python으로 하고 window 운영체제 한정이다.","headline":"[Python] Automation - 1. GUI","mainEntityOfPage":{"@type":"WebPage","@id":"https://ch-hey.github.io/posts/python-automation-gui/"},"url":"https://ch-hey.github.io/posts/python-automation-gui/"}</script><title>[Python] Automation - 1. GUI | ChBlog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ChBlog"><meta name="application-name" content="ChBlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.github.com/ch-hey/imgcdn/master/rocket.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ChBlog</a></div><div class="site-subtitle font-italic">Markdown to WEB</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ch-hey" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['haner1264','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[Python] Automation - 1. GUI</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[Python] Automation - 1. GUI</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1666180500" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 19, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/ch-hey">HEY</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2355 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><p>‘자동화’라는 것을 해보자. Python으로 하고 window 운영체제 한정이다.</p><p>보통 자동화라고 하면 단순 반복스러운 일들을 클릭 한번으로 화면이 휙휙 바뀌면서 막 컴퓨터가 알아서 해주는 그런 움짤들이 떠오른다. 좀 있어보이게 그런 것도 한번 해보자.</p><p>따지고보면 컴퓨터한테 어떤 일을 시킨다는 입장에서 정도의 차이야 있겠지만 모든 코딩은 자동화라고도 할수있지 않나 싶다. 구글링 해보니 <a href="https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&amp;blogId=aporia25&amp;logNo=221175414309">자동화의 의미에 대해 써놓은 글</a>도 있다.</p><h2 id="1-intro"><span class="mr-2">1. Intro</span><a href="#1-intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>먼저 다른 포스팅과는 다르게 이번에 다룰 내용들에는 컴퓨터 용어가 좀 많이 나온다. 본격적인 자동화를 시작하기 전에 몇 가지 용어들을 정리해보자. 구글링과 눈치로 대충 느낌만 알고있는 그런 용어들이라는 점 감안해주길 바란다. 다룰 용어에 대한 자세한 정의가 필요하다면 따로 찾아보기를 추천한다.</p><p>이번 포스팅에서 다룰 Python을 활용한 자동화는 크게 2가지로 분류할 수 있다. 하나는 GUI라는 것을 제어하는 것이고 다른 하나는 COM Object를 활용하는 것이다. 여기서는 GUI 자동화를 해본다.</p><p>GUI는 Graphical User Interface의 약자다. 관련한 자세한 자료는 <a href="https://ko.wikipedia.org/wiki/%EA%B7%B8%EB%9E%98%ED%94%BD_%EC%82%AC%EC%9A%A9%EC%9E%90_%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4">여기</a>와 <a href="https://namu.wiki/w/GUI">여기</a>를 읽어보자. 간단하게 사람이 컴퓨터로 일을 할 때 마우스와 키보드를 이용해서 화면에 뜬 아이콘이나 메뉴를 클릭하고 문자를 입력하고 하는 것을 생각하면 된다. GUI자동화는 이러한 마우스와 키보드의 동작을 미리 짜놓은 코드로 제어하는 것이다. 이러한 제어에 <code class="language-plaintext highlighter-rouge">pyautogui</code>라는 python 모듈이 쓰인다.</p><p>처음 이 모듈의 존재를 알았을 때 바로 게임매크로를 만들었었다. 핸드폰 게임이었는데 Android 에뮬레이터로 컴퓨터에서 주로 했었다. 게임 내 각 메뉴 이미지를 하나하나 캡쳐해서 저장해놓고 특정조건이 만족되면 특정 메뉴를 클릭하고 다음 단계를 진행하는 식의 코드였다. 게임이 자꾸 업데이트 되면서 메뉴 모양이 바뀌어 귀찮아서 그만뒀었지만 한동안 잘 가지고 놀았었다. 그래도 게임매크로는 왠만하면 만들지 말자..</p><p>경험상 원하는 자동화 기능구현이 쉽지만 얕은 수준에서의 자동화다. 못하는 읻도 많고 오류도 많다고 까지 말하고 싶기도 한데, 이건 코드를 짜는 사람 능력따라서도 다른거라서 쉽게 단정짓지는 못하겠다.</p><h2 id="2-gui"><span class="mr-2">2. GUI</span><a href="#2-gui" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>미리 짜놓은 코드대로 python이 키보드와 마우스를 움직여주는 GUI 자동화를 해보자. 슉슉 움직이는 움짤좀 만들어본다.</p><h3 id="21-pyautogui"><span class="mr-2">2.1. Pyautogui</span><a href="#21-pyautogui" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>pyautogui라는 모듈이 필요하다. 없다면 터미널에서 아래명령어로 설치해준다. 터미널이 뭔지 모듈 설치는 뭔지는 <a href="https://ch-hey.github.io/posts/Python-Start/">여기</a>를 참고하자.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip install pyautogui
</pre></table></code></div></div><p><a href="https://pyautogui.readthedocs.io/en/latest/">pyautogui 공식 문서</a>보다는 <a href="https://automatetheboringstuff.com/2e/chapter20/">여기</a>가 좀 더 설명이 쉬운거 같다. 여기코드를 배껴다 쓴다. pyautogui로는 아래 일들을 수행할 수 있다.</p><ul><li>screen(모니터) size 확인<li>마우스움직임 제어 (움직임, 드래그, 클릭, 더블클릭, 우클릭, 스크롤 등)<li>스크린샷 및 RGB 정보 확인<li>모니터 화면내 특정 이미지 위치 확인<li>키보드조작 (특정 문자열 작성, 특정 문자 입력 전송)</ul><p>대충 열거하자면 이정도다.</p><p>어찌됬든 여기서는 그림판을 실행하고 특정문양을 그리는 일을 pyautogui로 해본다. 전혀 의미없어 보이는 일이지만 이런거 조금 연습해보면 내가 하고싶은 진짜 자동화 해볼 수 있다.</p><h3 id="22-step-by-step"><span class="mr-2">2.2. Step by Step</span><a href="#22-step-by-step" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>하나씩 단계를 생각해보자. 여기서 하려는건 그림판에 특정 그림을 그리는 작업을 하려고 한다. 아래 단계대로 생각해보자.</p><ul><li>그림판 프로그램 실행<li>원하는 모양 그리기</ul><p>그림판 프로그램 실행부분만 더 세분화 해보자.</p><ul><li>그림판 프로그램 실행<ul><li>윈도우키를 누른다<li>그림판 프로그램을 찾는다 (시작화면에서 paint라고 친다)<li>그림판 프로그램을 실행한다 (Enter키를 누른다)</ul></ul><p>사람이 마우스와 키보드를 동작하는 순서 그대로를 차례대로 코드로 구현하면 된다. GUI 제어에서 조금 조심해야 할 점은 하나의 동작과 동작 사이에 적당한 시간차이를 두어야 한다는 점이다. 우리가 어떤 프로그램을 실행하라고 마우스로 더블클릭을 하든 엔터를 누르든간에 바로 열리는 것은 아니고 아주 약간의 지연시간이 있다. 이때 쓰는 코드는 <code class="language-plaintext highlighter-rouge">time</code> 모듈의 <code class="language-plaintext highlighter-rouge">sleep()</code>이다.</p><p>아래 코드를 실행하면 그림판이 실행된다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pyautogui</span> <span class="k">as</span> <span class="n">pg</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pg</span><span class="p">.</span><span class="n">press</span><span class="p">(</span><span class="s">"winleft"</span><span class="p">)</span>

<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pg</span><span class="p">.</span><span class="n">typewrite</span><span class="p">(</span><span class="s">"paint"</span><span class="p">)</span>

<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pg</span><span class="p">.</span><span class="n">press</span><span class="p">(</span><span class="s">"Enter"</span><span class="p">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">time.sleep(1)</code>은 여기에서 1초를 쉬라는 얘기다. 각 단계당 시간을 줄일수 있지만 너무 줄이면 다음단계가 실행되기 위한 화면이 뜨기전에 명령이 전달되면서 내가 원하는 동작이 구현되지 않을 수 있다. 1초정도는 기다리자.</p><p>paint는 그림판 프로그램의 영어 이름이다. 한글을 입력하는 방법은 좀 복잡한 것 같다. <a href="https://hashcode.co.kr/questions/5584/%ED%8C%8C%EC%9D%B4%EC%8D%AC-pyautoguitypewrite-%ED%95%9C%EA%B8%80-%EC%9E%85%EB%A0%A5-%EC%A7%88%EB%AC%B8%EC%9E%85%EB%8B%88%EB%8B%A4">여기</a>를 참고하자.</p><p>마지막에는 시작메뉴에서 그림판이 뜬 상태에서 Enter를 누른다. 이후에는 그림판 프로그램이 화면에 뜰 것이다.</p><p>남은 일은 모니터 화면에 실행된 그림판 프로그램에 특정 모양을 마우스로 그리는 것이다. 아래 단계를 생각해본다.</p><ul><li>원하는 모양 그리기<ul><li>모니터에 실행된 그림판 프로그램 빈 화면에 마우스를 댄다<li>원하는 모양을 그리도록 드래그 한다</ul></ul><p>코드는 합쳐서 아래처럼 쓸 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pg</span><span class="p">.</span><span class="n">press</span><span class="p">(</span><span class="s">"winleft"</span><span class="p">)</span>

<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pg</span><span class="p">.</span><span class="n">typewrite</span><span class="p">(</span><span class="s">"paint"</span><span class="p">)</span>

<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pg</span><span class="p">.</span><span class="n">press</span><span class="p">(</span><span class="s">"Enter"</span><span class="p">)</span>

<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pg</span><span class="p">.</span><span class="n">click</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">620</span><span class="p">)</span>
<span class="n">distance</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">change</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">while</span> <span class="n">distance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">pg</span><span class="p">.</span><span class="n">drag</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">change</span>
    <span class="n">pg</span><span class="p">.</span><span class="n">drag</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">pg</span><span class="p">.</span><span class="n">drag</span><span class="p">(</span><span class="o">-</span><span class="n">distance</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">-</span> <span class="n">change</span>
    <span class="n">pg</span><span class="p">.</span><span class="n">drag</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">distance</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">pg.click(50, 620)</code>은 모니터 화면 (50, 620)위치를 클릭하게 한다. 그림판 프로그램이 모니터 화면에 뜨는 위치는 직전에 실행했을때 종료한 위치에서 뜨는것으로 보인다. 실은 저 부분을 좀 더 오류없이 처리하려면 모니터 화면에서 그림판 프로그램의 특정메뉴 아이콘을 캡쳐해둬서 그 위치를 인식하도록 하는 것이 더 좋을 것이다. <code class="language-plaintext highlighter-rouge">pyautogui.locateOnScreen()</code> 함수를 쓰면 된다. 여기서는 굳이 여기까지 하진 않겠다.</p><p>실행 결과는 아래처럼 움직인다. (영상이 실행안되면 F5로 새로고침 한다.)</p><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-10-19/Animation_total_final.gif" alt="Automation_움짤" data-proofer-ignore></p><p>간단한 동작을 위한 간단한 코드. 알아보고 생각할 건 조금 있었지만 어렵지 않게 구현됬다. pyautogui와 적당한 조건문, 반복문의 조합으로 기상천외한 일들 할 수 있을 것이다.</p><h2 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>GUI 자동화는 일단 직관적이다. 내가 평소에 마우스 키보드 조작하던 것을 하나씩 단계별로 코드작성하면 됬다. 각 동작마다 조금씩 기다리도록 주의하면 된다. 화면이 변하는것을 보면 괜히 뭐 있어보이고 재밌기도 하다.</p><p>그런데, 이정도를 자동화 혹은 RPA라고 말하기는 뭔가 애매하다. 자동화가 아닌건 아닌데 좀 더 많은 것을 오류없이 일을 처리하고 싶다.</p><p>예를 들면 컴퓨터가 성능이 좀 떨어져서 혹은 인터넷환경처럼 특정 페이지가 로딩되는데 오래걸리거나 프로그램 실행중 오류가 생기는 경우를 생각해보자. 사람이라면 조금 기다리던지 다시 프로그램을 실행할 것이다. 하지만 GUI자동화 방식은 코드 전체가 내 의도와 다르게 작동할 가능성이 매우 높다. 뭔가 컴퓨터와 더 깊은 대화가 필요하다. 다음번에는 COM Object 써보자.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/python/'>Python</a>, <a href='/categories/automation/'>Automation</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >Automation</a> <a href="/tags/gui/" class="post-tag no-text-decoration" >GUI</a> <a href="/tags/pyautogui/" class="post-tag no-text-decoration" >pyautogui</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5BPython%5D+Automation+-+1.+GUI+-+ChBlog&url=https%3A%2F%2Fch-hey.github.io%2Fposts%2Fpython-automation-gui%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5BPython%5D+Automation+-+1.+GUI+-+ChBlog&u=https%3A%2F%2Fch-hey.github.io%2Fposts%2Fpython-automation-gui%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fch-hey.github.io%2Fposts%2Fpython-automation-gui%2F&text=%5BPython%5D+Automation+-+1.+GUI+-+ChBlog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/venv-Python-32bit/">[Python] Virtual Env(venv)로 가상환경 만들기</a><li><a href="/posts/AI-Tensorflow/">[머신러닝] Tensorflow</a><li><a href="/posts/Neural-Network/">[머신러닝] 인공신경망 Artificial Neural Network</a><li><a href="/posts/Engineering-Calculation/">[Eng. Calc.] Differential Equations - Kinetics</a><li><a href="/posts/Orientation/">Orientation</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/engineering-calculation/">Engineering Calculation</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/andrew-ng/">Andrew NG</a> <a class="post-tag" href="/tags/aspen-plus/">Aspen Plus</a> <a class="post-tag" href="/tags/com-object/">COM Object</a> <a class="post-tag" href="/tags/coursera/">Coursera</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/python-automation-COM/"><div class="card-body"> <em class="small" data-ts="1667994900" data-df="ll" > Nov 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Python] Automation - 2. COM Object</h3><div class="text-muted small"><p> 좀 더 고급진 ‘자동화’라는 것을 해보자. 마찬가지로 Python으로 하고 window 운영체제 한정이다. 조금만 더 자동화에 대해 파보면 나같은 프로그래밍 초심자는 이해하기 힘든 용어들이 쏟아져 나온다. 대표적으로 API가 그랬고 ProgID 등등 뭐 많았다. 아직 잘 모르겠지만 COM Object도 결국 API중에 하나인건가 싶다. 다 알아두면...</p></div></div></a></div><div class="card"> <a href="/posts/Neural-Network/"><div class="card-body"> <em class="small" data-ts="1660910100" data-df="ll" > Aug 19, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[머신러닝] 인공신경망 Artificial Neural Network</h3><div class="text-muted small"><p> 인공신경망에 대해 알아본다. 먼저 수학적인 표현에 대해 살펴본 이후 아주 간단한 구조의 인공신경망에 Gradient Descent를 적용해본다. 정리된 알고리즘대로 Python으로 Machine Learning도 진행한다. 1. Intro Michael Nielsen의 “Neural Networks and Deep Learning”은 인공신경망에 ...</p></div></div></a></div><div class="card"> <a href="/posts/Engineering-Calculation/"><div class="card-body"> <em class="small" data-ts="1661169300" data-df="ll" > Aug 22, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Eng. Calc.] Differential Equations - Kinetics</h3><div class="text-muted small"><p> 공학용 계산 첫 번째 포스팅이다. 첫번째 주제는 반응속도식 문제 풀이다. 수학으로는 미분방정식 풀이와 fitting 예제에 해당한다. 계산에는 Python을 쓴다. 1. Intro 간단한 문제에서부터 시작하려고 한다. 이 문서의 예제와 데이터를 따라가본다. 아래 반응을 보자. [A \rightarrow B] 반응속도식을 정하는건 이런저런 고려들...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Engineering-Calculation4/" class="btn btn-outline-primary" prompt="Older"><p>[Eng. Calc.] Symbolic Computation</p></a> <a href="/posts/python-automation-COM/" class="btn btn-outline-primary" prompt="Newer"><p>[Python] Automation - 2. COM Object</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ch-hey">HEY</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/engineering-calculation/">Engineering Calculation</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/andrew-ng/">Andrew NG</a> <a class="post-tag" href="/tags/aspen-plus/">Aspen Plus</a> <a class="post-tag" href="/tags/com-object/">COM Object</a> <a class="post-tag" href="/tags/coursera/">Coursera</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
