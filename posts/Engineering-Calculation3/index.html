<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[Eng. Calc.] Nonlinear Equations Solving" /><meta property="og:locale" content="en" /><meta name="description" content="이번 공학용계산 포스팅의 주제는 Equation Solving, 방정식 풀이다." /><meta property="og:description" content="이번 공학용계산 포스팅의 주제는 Equation Solving, 방정식 풀이다." /><link rel="canonical" href="https://ch-hey.github.io/posts/Engineering-Calculation3/" /><meta property="og:url" content="https://ch-hey.github.io/posts/Engineering-Calculation3/" /><meta property="og:site_name" content="ChBlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-18T19:55:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Eng. Calc.] Nonlinear Equations Solving" /><meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-18T19:55:00+08:00","datePublished":"2022-09-18T19:55:00+08:00","description":"이번 공학용계산 포스팅의 주제는 Equation Solving, 방정식 풀이다.","headline":"[Eng. Calc.] Nonlinear Equations Solving","mainEntityOfPage":{"@type":"WebPage","@id":"https://ch-hey.github.io/posts/Engineering-Calculation3/"},"url":"https://ch-hey.github.io/posts/Engineering-Calculation3/"}</script><title>[Eng. Calc.] Nonlinear Equations Solving | ChBlog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ChBlog"><meta name="application-name" content="ChBlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.github.com/ch-hey/imgcdn/master/rocket.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ChBlog</a></div><div class="site-subtitle font-italic">Markdown to WEB</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ch-hey" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['haner1264','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[Eng. Calc.] Nonlinear Equations Solving</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[Eng. Calc.] Nonlinear Equations Solving</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1663502100" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 18, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/ch-hey">HEY</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2571 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><p>이번 공학용계산 포스팅의 주제는 Equation Solving, 방정식 풀이다.</p><p>선형방정식에 대한 풀이는 손으로도 쉽게 풀리기 때문에 여기서는 비선형방정식에 대한 풀이를 다뤄본다. 복잡한 수치해석적인 방법에 대한 소개는 없다. Python으로 어떻게 비선형방정식을 푸는지, 어떤 모듈이 필요한지 계산 예시를 통해 소개한다.</p><p>화학공학에서 종종 만나게 되는 상태방정식을 통한 물성 계산을 예로 들어본다.</p><h2 id="1-intro"><span class="mr-2">1. Intro</span><a href="#1-intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>상태방정식을 통해 순수물질의 물성을 계산해 보고자 한다. <a href="https://pubs.usgs.gov/of/2005/1451/equation.html">Peng-Robison 상태방정식</a>을 사용할 것이다. 계산에 필요한 식들은 아래와 같이 주어져 있다.</p>\[P = {RT \over V-b} - {a \alpha \over V^2 + 2bV - b^2} \qquad(1a)\] \[P = {\rho RT \over 1-\rho b} - {a \alpha \rho^2 \over 1 + 2b\rho - (\rho b)^2} \qquad(1b)\] \[a = 0.45724{R^2{T_c^2} \over P_c}, \ b = 0.07780{R T_c \over P_c}\] \[\alpha = [1 + (0.37464 + 1.54226\omega - 0.26992\omega^2)(1 - T_r^{0.5})]^2\] \[A = {a \alpha P \over R^2T^2}, \ B = {b P \over RT}\]<p>in Polynomial form:</p>\[Z^3 - (1 - B)Z^2 + (A - 3B^2 - 2B)Z - (AB - B^2 - B^3) = 0 \qquad(2)\]<p>Fugacity:</p>\[\ln\phi = Z - 1 - \ln(Z-B) - {A \over 2\sqrt{2} B}\ln{Z + 2.414B \over Z - 0.414B} \qquad(3)\]<p>$P$는 압력, $T$는 온도, $V$는 부피, $\rho$는 밀도, $T_c$는 임계온도, $P_c$는 임계압력, $w$는 acentric factor, $Z$는 압축인자, $\phi$는 fugacity 이다.</p><p>기체상수 R은 아래와 같이 사용할 단위에 맞게 조정해준다.</p>\[8.314 {J \over mol \ K} \ {Pa \ m^3 \over J} \ {bar \over 10^5Pa} \ {10^6 cm^3 \over m^3} = 83.14 {bar \ cm^3 \over mol \ K}\]<p>뭔가 복잡해보인다. 하지만 Python이 다 풀어줄 것이다. 우리가 해야 할 것은 어떤 수식을 풀어달라고 코드짜는 것뿐이다. 이거 하려면 결국 해결할 문제를 수학적으로 표현하고 이해하는 것이 필요하다. 상태방정식을 공부할 필요는 없다. 그저 저런 식들을 푸는데 이런 Python 모듈을 쓰는구나, 내가 풀 문제는 이거니까 이렇게 고쳐봐야지 이정도만 생각하면 충분하다.</p><h2 id="2-equation-solving---mono-variable"><span class="mr-2">2. Equation solving - Mono-Variable</span><a href="#2-equation-solving---mono-variable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="21-liquid-density-at-specified-temperature--pressure"><span class="mr-2">2.1. Liquid density at specified Temperature &amp; Pressure</span><a href="#21-liquid-density-at-specified-temperature--pressure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>간단한 상황을 생각해본다. 먼저 온도가 충분히 높고 압력이 충분히 낮아서 기체상으로만 존재하는 상태에서 물질의 밀도를 계산해보려고 한다. <a href="https://webbook.nist.gov/chemistry/fluid/">NIST Data</a>에 따르면 n-Hexane은 447K, 5.1bar에서 기체로만 존재하며 밀도는 0.00015228 mol/cm<sup>3</sup> 라고 한다.</p><p>Peng-Robinson 상태방정식은 아래와 같이 순수물질의 물성을 요구한다.</p><ul><li>Critical Temperature ($T_c$): 507.82 K<li>Critical Pressure ($P_c$): 30.441 bar<li>Acentric factor ($w$): 0.30</ul><p>식 (1b)를 보면 온도, 압력, 밀도간의 관계식이 주어져있다. 여기에 온도, 압력을 넣어주면 밀도만의 비선형 식으로 정리되며 이를 풀면 원하는 기체 밀도를 얻을 수 있다. 1개의 식이 1개의 변수에 대해서만 표현되어 있어 문제를 풀 수 있다.</p><h3 id="22-python-code"><span class="mr-2">2.2. Python Code</span><a href="#22-python-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>언제나 그렇듯 <code class="language-plaintext highlighter-rouge">numpy</code>, <code class="language-plaintext highlighter-rouge">scipy.optimize</code>, <code class="language-plaintext highlighter-rouge">matplotlib</code>이 사용된다. <code class="language-plaintext highlighter-rouge">scipy</code>모듈은 공학용 계산에서 빼놓을 수 없을 것 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="n">R</span> <span class="o">=</span> <span class="mf">83.14</span> <span class="c1"># P in bar, V in cm3/mol, T in kelvin
## Parameter for n-Hexane, Data from NIST
</span><span class="n">Tc</span> <span class="o">=</span> <span class="mf">507.82</span>
<span class="n">Pc</span> <span class="o">=</span> <span class="mf">30.441</span>
<span class="n">w</span> <span class="o">=</span> <span class="mf">0.30</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">0.45724</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">Pc</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">0.07780</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>

<span class="k">def</span> <span class="nf">alpha</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.37464</span> <span class="o">+</span> <span class="mf">1.54226</span> <span class="o">*</span> <span class="n">w</span> <span class="o">-</span> <span class="mf">0.26992</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">temp</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">pres</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">den</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">*</span><span class="n">temp</span><span class="o">*</span><span class="n">den</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">den</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">alpha</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">den</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">den</span><span class="o">-</span><span class="p">(</span><span class="n">den</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">tempp</span> <span class="o">=</span> <span class="mi">447</span>
<span class="n">presp</span> <span class="o">=</span> <span class="mf">5.1</span>

<span class="k">def</span> <span class="nf">pres_fsol</span><span class="p">(</span><span class="n">den</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">pres</span><span class="p">(</span><span class="n">tempp</span><span class="p">,</span> <span class="n">den</span><span class="p">)</span><span class="o">-</span><span class="n">presp</span><span class="p">)</span>

<span class="n">root_v</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">pres_fsol</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">root_v</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"solution is </span><span class="si">{</span><span class="mf">0.00015228</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> mol/cm3, Calculation result is </span><span class="si">{</span><span class="n">root_v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> mol/cm3"</span><span class="p">)</span>

</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>[0.0001526]
solution is 0.000152 mol/cm3, Calculation result is 0.000153 mol/cm3
</pre></table></code></div></div><p>위에서 정의한 <code class="language-plaintext highlighter-rouge">pres</code>라는 함수가 식(1b)와 동일한 식이다. <code class="language-plaintext highlighter-rouge">pres_fsol</code>은 식(1b)로 표현되는 압력에서 5.1bar를 빼준 값을 return 해주는 함수로 0이 되어야 할 방정식에 해당한다. 바로 밑에 <code class="language-plaintext highlighter-rouge">scipy.optimize</code>에 있는 <code class="language-plaintext highlighter-rouge">fsolve</code>라는 명령어로 0이 되어야 할 함수인 <code class="language-plaintext highlighter-rouge">pres_fsol</code>을 풀어주며 밀도값인 0.0001526이 얻어졌다.</p><p>그렇게 복잡하진 않다. 0이 되어야 하는 함수를 정의해주고 <code class="language-plaintext highlighter-rouge">fsolve</code> 명령어로 적절한 초기값을 넣어서 실행시켜주면 답이 얻어진다. 0이 되어야 할 함수, 초기값 이 두개만 기억하자.</p><p>초기값은 적당한 값을 넣어주는데 값에 대한 힌트가 전혀 없다면 0이 되어야 할 함수를 변수에 대해 plot해보면서 확인하는 것을 추천한다. (위 경우에는 <code class="language-plaintext highlighter-rouge">pres_fsol</code>을 <code class="language-plaintext highlighter-rouge">den</code>에 대해 plot해볼수 있을 것이다. 아래코드처럼 하면 된다.)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">den_plot</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.006</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">den_plot</span><span class="p">,</span> <span class="n">pres</span><span class="p">(</span><span class="n">tempp</span><span class="p">,</span> <span class="n">den_plot</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="3-equation-solving---multi-variable"><span class="mr-2">3. Equation solving - Multi-Variable</span><a href="#3-equation-solving---multi-variable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>비선형식 1개를 푸는 것을 해봤다. 이번엔 여러개를 동시에 풀어보자. Code는 정확히 똑같은 흐름으로 진행된다.</p><h3 id="31-phase-equilibrium-calculation-for-pure-substance"><span class="mr-2">3.1. Phase Equilibrium Calculation for Pure Substance</span><a href="#31-phase-equilibrium-calculation-for-pure-substance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>상평형에 대한 계산은 알아야 할 여러 배경지식들이 있지만 일단 여기서는 복잡한 비선형방정식 시스템을 풀이하는 것을 목적으로 하므로 다 생략하고 어떤 식을 풀어야 하는지 상황만 설정해본다.</p><p>특정 온도에서 Hexane이 기상과 액상의 형태로 공존하는 압력이 존재하며 각 상에서의 밀도를 계산하고자 한다.</p><p>변수의 종류는 온도 $T$, 이때의 압력 $P$, 액상의 압축인자 $Z_L$, 기상의 압축인자 $Z_V$ 4개이다.</p><p>input으로 온도가 주어지므로 unknonwn의 개수는 3개이며 이를 구하기 위해 아래 3개의 식이 활용된다.</p><p>Polynomial Form:</p>\[Z_L^3 - (1 - B)Z_L^2 + (A - 3B^2 - 2B)Z_L - (AB - B^2 - B^3) = 0 \qquad(4)\] \[Z_V^3 - (1 - B)Z_V^2 + (A - 3B^2 - 2B)Z_V - (AB - B^2 - B^3) = 0 \qquad(5)\]<p>Equal Fugacity:</p>\[\ln\phi_L = \ln\phi_V \qquad (6)\] \[\ln\phi_L = Z_L - 1 - \ln(Z_L-B) - {A \over 2\sqrt{2} B}\ln{Z_L + 2.414B \over Z_L - 0.414B}\] \[\ln\phi_V = Z_V - 1 - \ln(Z_V-B) - {A \over 2\sqrt{2} B}\ln{Z_V + 2.414B \over Z_V - 0.414B}\]<p>이렇게 구해진 변수들로 액상, 기상의 밀도도 계산할 수 있다.</p>\[\rho_L = {P \over Z_LRT}, \ \rho_V = {P \over Z_VRT}\]<h3 id="32-python-code"><span class="mr-2">3.2. Python Code</span><a href="#32-python-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>위에서 사용한 Code에서 이어서 쓴다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">fugz</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">alpha</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="p">((</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">temp</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">temp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">B</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">B</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">((</span><span class="n">z</span> <span class="o">+</span> <span class="mf">2.414</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mf">0.414</span><span class="o">*</span><span class="n">B</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">zcubic</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">alpha</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="p">((</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">temp</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">temp</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">B</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">B</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="o">-</span><span class="p">(</span><span class="n">B</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">B</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">equileqnz</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">zl</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">zv</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">fugzl</span> <span class="o">=</span> <span class="n">fugz</span><span class="p">(</span><span class="n">tempp</span><span class="p">,</span> <span class="n">zl</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">fugzv</span> <span class="o">=</span> <span class="n">fugz</span><span class="p">(</span><span class="n">tempp</span><span class="p">,</span> <span class="n">zv</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">zcubicl</span> <span class="o">=</span> <span class="n">zcubic</span><span class="p">(</span><span class="n">tempp</span><span class="p">,</span> <span class="n">zl</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">zcubicv</span> <span class="o">=</span> <span class="n">zcubic</span><span class="p">(</span><span class="n">tempp</span><span class="p">,</span> <span class="n">zv</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">zcubicl</span><span class="p">,</span> <span class="n">zcubicv</span><span class="p">,</span> <span class="n">fugzl</span><span class="o">-</span><span class="n">fugzv</span><span class="p">]</span>

<span class="n">tempp</span> <span class="o">=</span> <span class="mi">267</span>

<span class="n">root_z</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">equileqnz</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0002</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.041</span><span class="p">])</span>

<span class="n">root</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">temp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tempp</span><span class="p">]</span>
<span class="n">root</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">root_z</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[2.52339063e-04 9.96564628e-01 4.47879861e-02]
</pre></table></code></div></div><p>동시에 풀어야 할 식이 3개이므로 3개의 식을 list형태로 return 해주는 <code class="language-plaintext highlighter-rouge">equileqnz</code>라는 함수를 정의한다. 3개의 식은 0이 되어야 하는 식(4), (5), (6)에 해당한다. 초기값은 식이 복잡하다보니 상당히 민감해서 거의 답 근처를 지정해 주어야 했다. 얻어진 답은 root라는 list에 담아준다. 이는 다른 온도에서의 답을 구하기 위한 초기값으로 사용될 것이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">Tc</span><span class="p">)</span><span class="o">-</span><span class="mi">267</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">tempp</span> <span class="o">=</span> <span class="n">tempp</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">temp_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tempp</span><span class="p">)</span>
    <span class="n">root_z</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">equileqnz</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">root</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">root_z</span><span class="p">)</span>
    <span class="c1"># print(f'temp = {tempp}, zl = {root_z[0]}, zv = {root_z[1]}, pres = {root_z[2]}')
</span></pre></table></code></div></div><p>온도를 1씩 증가시키면서 반복적으로 <code class="language-plaintext highlighter-rouge">fsolve</code> 해준다. 초기값은 직전step에서 구한 답을 활용한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">root_all</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">temp_list</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>

<span class="n">sat_pres</span> <span class="o">=</span> <span class="n">root_all</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">denl</span> <span class="o">=</span> <span class="n">sat_pres</span><span class="o">/</span><span class="p">(</span><span class="n">root_all</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">temp_list</span><span class="p">)</span>
<span class="n">denv</span> <span class="o">=</span> <span class="n">sat_pres</span><span class="o">/</span><span class="p">(</span><span class="n">root_all</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">temp_list</span><span class="p">)</span>
</pre></table></code></div></div><p><a href="https://webbook.nist.gov/chemistry/fluid/">NIST Webbook</a>에서 아래와 같이 n-Hexane의 Saturated Properties를 얻을 수 있다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Temperature (K)<th style="text-align: right">Pressure (bar)<th style="text-align: right">Density (l, mol/l)<th style="text-align: right">Density (v, mol/l)<tbody><tr><td style="text-align: center">267<td style="text-align: right">0.043069<td style="text-align: right">7.9198<td style="text-align: right">0.0019495<tr><td style="text-align: center">307<td style="text-align: right">0.1215<td style="text-align: right">7.7147<td style="text-align: right">0.0051461<tr><td style="text-align: center">287<td style="text-align: right">0.29223<td style="text-align: right">7.504<td style="text-align: right">0.011684<tr><td style="text-align: center">327<td style="text-align: right">0.61954<td style="text-align: right">7.2858<td style="text-align: right">0.023603<tr><td style="text-align: center">347<td style="text-align: right">1.1873<td style="text-align: right">7.0582<td style="text-align: right">0.043526<tr><td style="text-align: center">367<td style="text-align: right">2.0971<td style="text-align: right">6.8183<td style="text-align: right">0.074768<tr><td style="text-align: center">387<td style="text-align: right">3.4657<td style="text-align: right">6.5624<td style="text-align: right">0.12159<tr><td style="text-align: center">407<td style="text-align: right">5.4239<td style="text-align: right">6.2853<td style="text-align: right">0.18976<tr><td style="text-align: center">427<td style="text-align: right">8.1157<td style="text-align: right">5.9785<td style="text-align: right">0.28779<tr><td style="text-align: center">447<td style="text-align: right">11.703<td style="text-align: right">5.6277<td style="text-align: right">0.42989<tr><td style="text-align: center">467<td style="text-align: right">16.371<td style="text-align: right">5.2031<td style="text-align: right">0.64382<tr><td style="text-align: center">487<td style="text-align: right">22.355<td style="text-align: right">4.6283<td style="text-align: right">1.0025<tr><td style="text-align: center">507<td style="text-align: right">30.07<td style="text-align: right">3.2679<td style="text-align: right">2.151</table></div><p>아래처럼 입력해준다. txt나 excel파일로 정리해서 python으로 읽어들어올수도 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">exp_temp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">267</span><span class="p">,</span><span class="mi">287</span><span class="p">,</span><span class="mi">307</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">347</span><span class="p">,</span><span class="mi">367</span><span class="p">,</span><span class="mi">387</span><span class="p">,</span><span class="mi">407</span><span class="p">,</span><span class="mi">427</span><span class="p">,</span><span class="mi">447</span><span class="p">,</span><span class="mi">467</span><span class="p">,</span><span class="mi">487</span><span class="p">,</span><span class="mi">507</span><span class="p">]</span>
<span class="n">exp_denl</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.9198</span><span class="p">,</span><span class="mf">7.7147</span><span class="p">,</span><span class="mf">7.504</span><span class="p">,</span><span class="mf">7.2858</span><span class="p">,</span><span class="mf">7.0582</span><span class="p">,</span><span class="mf">6.8183</span><span class="p">,</span><span class="mf">6.5624</span><span class="p">,</span><span class="mf">6.2853</span><span class="p">,</span><span class="mf">5.9785</span><span class="p">,</span><span class="mf">5.6277</span><span class="p">,</span><span class="mf">5.2031</span><span class="p">,</span><span class="mf">4.6283</span><span class="p">,</span><span class="mf">3.2679</span><span class="p">]</span>
<span class="n">exp_denv</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0019495</span><span class="p">,</span><span class="mf">0.0051461</span><span class="p">,</span><span class="mf">0.011684</span><span class="p">,</span><span class="mf">0.023603</span><span class="p">,</span><span class="mf">0.043526</span><span class="p">,</span><span class="mf">0.074768</span><span class="p">,</span><span class="mf">0.12159</span><span class="p">,</span><span class="mf">0.18976</span><span class="p">,</span><span class="mf">0.28779</span><span class="p">,</span><span class="mf">0.42989</span><span class="p">,</span><span class="mf">0.64382</span><span class="p">,</span><span class="mf">1.0025</span><span class="p">,</span><span class="mf">2.151</span><span class="p">]</span>
<span class="n">exp_psat</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.043069</span><span class="p">,</span><span class="mf">0.1215</span><span class="p">,</span><span class="mf">0.29223</span><span class="p">,</span><span class="mf">0.61954</span><span class="p">,</span><span class="mf">1.1873</span><span class="p">,</span><span class="mf">2.0971</span><span class="p">,</span><span class="mf">3.4657</span><span class="p">,</span><span class="mf">5.4239</span><span class="p">,</span><span class="mf">8.1157</span><span class="p">,</span><span class="mf">11.703</span><span class="p">,</span><span class="mf">16.371</span><span class="p">,</span><span class="mf">22.355</span><span class="p">,</span><span class="mf">30.07</span><span class="p">]</span>
<span class="n">exp_temp</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp_temp</span><span class="p">)</span>
<span class="n">exp_denl</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp_denl</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">exp_denv</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp_denv</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">exp_psat</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp_psat</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">denl</span><span class="p">,</span> <span class="n">temp_list</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">denv</span><span class="p">,</span> <span class="n">temp_list</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">exp_denl</span><span class="p">,</span> <span class="n">exp_temp</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">exp_denv</span><span class="p">,</span> <span class="n">exp_temp</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'density (mol/cm3)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Temperature (K)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'saturated density vs temperature'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp_list</span><span class="p">,</span> <span class="n">sat_pres</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">exp_temp</span><span class="p">,</span> <span class="n">exp_psat</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Temperature (K)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Pressure (bar)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Saturated Vapor Pressure Curve'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-09-18/output_8_0.png" alt="png" data-proofer-ignore></p><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-09-18/output_8_1.png" alt="png" data-proofer-ignore></p><p>데이터와 함께 이쁘게 Plot해주자. 계산값은 선에 해당하고 점들은 Data다. 계산이 잘 수행된 것 같다. Peng-Robinson 상태방정식은 꽤나 quality가 훌륭했다. 물리적으로 의미가 안맞을 수도 있지만 앞선 Regression 예제와 함께 생각해보면 데이터에 잘 맞는 파라미터($T_c, \ P_c, \ w$)를 얻을 수도 있을 것이다.</p><h2 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>비선형 방정식 풀이를 해봤다. <code class="language-plaintext highlighter-rouge">scipy.optimize.fsolve</code>를 활용했고 0이 되어야 할 함수를 지정해 주는 것과 초기값을 넣는 것에 주의해야 한다는 것을 알았다.</p><p>적당한 예시를 찾느라 상태방정식을 가져오긴 했는데, 지금와서 보니 그렇게 좋은 예시는 아니었던 것 같다. 식이 어떻게 저렇게 수립되는지는 전혀 신경 쓰지 말고 풀어야 하는 방정식 시스템이 어떻게 Python Code로 풀리는지 보는게 이번 포스팅의 의도와도 맞다.</p><p>어디까지나 Technical한 얘기였고 항상 마무리는 이거 다 필요없다는 거다. 정작 중요한 것은 풀어야 할 식을 수학적으로 표현해내는 과정이다. 여기가 실은 가장 시간을 많이 써야하는 부분이고 중요한 단계다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/engineering-calculation/'>Engineering Calculation</a>, <a href='/categories/equation-solving/'>Equation Solving</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/engineering-calculation/" class="post-tag no-text-decoration" >Engineering Calculation</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/nonlinear-equation-solving/" class="post-tag no-text-decoration" >Nonlinear Equation Solving</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5BEng.+Calc.%5D+Nonlinear+Equations+Solving+-+ChBlog&url=https%3A%2F%2Fch-hey.github.io%2Fposts%2FEngineering-Calculation3%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5BEng.+Calc.%5D+Nonlinear+Equations+Solving+-+ChBlog&u=https%3A%2F%2Fch-hey.github.io%2Fposts%2FEngineering-Calculation3%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fch-hey.github.io%2Fposts%2FEngineering-Calculation3%2F&text=%5BEng.+Calc.%5D+Nonlinear+Equations+Solving+-+ChBlog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/venv-Python-32bit/">[Python] Virtual Env(venv)로 가상환경 만들기</a><li><a href="/posts/AI-Tensorflow/">[머신러닝] Tensorflow</a><li><a href="/posts/Neural-Network/">[머신러닝] 인공신경망 Artificial Neural Network</a><li><a href="/posts/Engineering-Calculation/">[Eng. Calc.] Differential Equations - Kinetics</a><li><a href="/posts/Orientation/">Orientation</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/engineering-calculation/">Engineering Calculation</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/andrew-ng/">Andrew NG</a> <a class="post-tag" href="/tags/aspen-plus/">Aspen Plus</a> <a class="post-tag" href="/tags/com-object/">COM Object</a> <a class="post-tag" href="/tags/coursera/">Coursera</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Engineering-Calculation/"><div class="card-body"> <em class="small" data-ts="1661169300" data-df="ll" > Aug 22, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Eng. Calc.] Differential Equations - Kinetics</h3><div class="text-muted small"><p> 공학용 계산 첫 번째 포스팅이다. 첫번째 주제는 반응속도식 문제 풀이다. 수학으로는 미분방정식 풀이와 fitting 예제에 해당한다. 계산에는 Python을 쓴다. 1. Intro 간단한 문제에서부터 시작하려고 한다. 이 문서의 예제와 데이터를 따라가본다. 아래 반응을 보자. [A \rightarrow B] 반응속도식을 정하는건 이런저런 고려들...</p></div></div></a></div><div class="card"> <a href="/posts/Engineering-Calculation2/"><div class="card-body"> <em class="small" data-ts="1662378900" data-df="ll" > Sep 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Eng. Calc.] Regression and Curve-Fit</h3><div class="text-muted small"><p> 이번 공학용 계산 주제는 Regression 이다. 편의상 Fitting 이라고도 한다. Regression, Fitting 원래는 명확한 구분이 있을거 같으면서도 굉장히 혼용되서 사용되는 단어 같다. 실은 딱히 명확한 구분은 없는 것 같다. 관련해선 이 문서를 한 번 읽어보자. 여기서는 변수, independent variable $x$에 대해서 ...</p></div></div></a></div><div class="card"> <a href="/posts/Engineering-Calculation4/"><div class="card-body"> <em class="small" data-ts="1666007700" data-df="ll" > Oct 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Eng. Calc.] Symbolic Computation</h3><div class="text-muted small"><p> 이번 공학용계산 포스팅의 주제는 Symbolic Computation, 기호 계산(?)이다. 개인적으로는 보통 그냥 심볼릭한 계산이라고 부른다. Symbolic Calculation이라고 검색해보려 했는데 구글에서 자동완성으로 Computation을 추천한다. 고민없이 Computation을 쓰자. Symbolic한 계산이란 것은 인간이 수행하는 문...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Engineering-Calculation2/" class="btn btn-outline-primary" prompt="Older"><p>[Eng. Calc.] Regression and Curve-Fit</p></a> <a href="/posts/Engineering-Calculation4/" class="btn btn-outline-primary" prompt="Newer"><p>[Eng. Calc.] Symbolic Computation</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ch-hey">HEY</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/engineering-calculation/">Engineering Calculation</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/andrew-ng/">Andrew NG</a> <a class="post-tag" href="/tags/aspen-plus/">Aspen Plus</a> <a class="post-tag" href="/tags/com-object/">COM Object</a> <a class="post-tag" href="/tags/coursera/">Coursera</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
