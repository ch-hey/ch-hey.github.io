<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[Eng. Calc.] Differential Equations - Kinetics" /><meta property="og:locale" content="en" /><meta name="description" content="공학용 계산 첫 번째 포스팅이다. 첫번째 주제는 반응속도식 문제 풀이다. 수학으로는 미분방정식 풀이와 fitting 예제에 해당한다. 계산에는 Python을 쓴다." /><meta property="og:description" content="공학용 계산 첫 번째 포스팅이다. 첫번째 주제는 반응속도식 문제 풀이다. 수학으로는 미분방정식 풀이와 fitting 예제에 해당한다. 계산에는 Python을 쓴다." /><link rel="canonical" href="https://ch-hey.github.io/posts/Engineering-Calculation/" /><meta property="og:url" content="https://ch-hey.github.io/posts/Engineering-Calculation/" /><meta property="og:site_name" content="ChBlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-22T19:55:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Eng. Calc.] Differential Equations - Kinetics" /><meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-08-26T22:25:07+08:00","datePublished":"2022-08-22T19:55:00+08:00","description":"공학용 계산 첫 번째 포스팅이다. 첫번째 주제는 반응속도식 문제 풀이다. 수학으로는 미분방정식 풀이와 fitting 예제에 해당한다. 계산에는 Python을 쓴다.","headline":"[Eng. Calc.] Differential Equations - Kinetics","mainEntityOfPage":{"@type":"WebPage","@id":"https://ch-hey.github.io/posts/Engineering-Calculation/"},"url":"https://ch-hey.github.io/posts/Engineering-Calculation/"}</script><title>[Eng. Calc.] Differential Equations - Kinetics | ChBlog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ChBlog"><meta name="application-name" content="ChBlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.github.com/ch-hey/imgcdn/master/rocket.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ChBlog</a></div><div class="site-subtitle font-italic">Markdown to WEB</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ch-hey" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['haner1264','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[Eng. Calc.] Differential Equations - Kinetics</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[Eng. Calc.] Differential Equations - Kinetics</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1661169300" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 22, 2022 </em> </span> <span> Updated <em class="" data-ts="1661523907" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 26, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/ch-hey">HEY</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3689 words"> <em>20 min</em> read</span></div></div></div><div class="post-content"><p>공학용 계산 첫 번째 포스팅이다. 첫번째 주제는 반응속도식 문제 풀이다. 수학으로는 미분방정식 풀이와 fitting 예제에 해당한다. 계산에는 Python을 쓴다.</p><h2 id="1-intro"><span class="mr-2">1. Intro</span><a href="#1-intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>간단한 문제에서부터 시작하려고 한다. <a href="https://symfit.readthedocs.io/en/stable/examples/ex_ODEModel.html">이 문서</a>의 예제와 데이터를 따라가본다. 아래 반응을 보자.</p>\[A \rightarrow B\]<p>반응속도식을 정하는건 이런저런 고려들이 들어가는 복잡한 일이지만 일단 간단하게 반응차수는 1로 아래처럼 정리된다고 가정하자.</p>\[{dC_A \over dt} = -k_1 C_A \qquad (1)\]<p>A라는 물질의 시간에 따른 농도변화는 A의 농도에 비례하며 비례상수는 반응속도상수인 $k_1$이다. A는 B로 변하면서 농도가 감소할 것이기 때문에 음수가 붙는다. 일반적으로 반응 실험 Data로부터 $k_1$을 Regression하고 다른 온도조건에서의 반응결과 예측이나 반응기 설계 등에 활용된다.</p><h2 id="2-background"><span class="mr-2">2. Background</span><a href="#2-background" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>식 1을 푸는 방식은 크게 2가지다. 손으로 미분방정식을 풀어서 해석해를 구하거나 수치적으로 근사해서 풀이한다. (Analytic solution을 구하거나 numerical solution을 구한다.)</p><h3 id="21-analytic-solution"><span class="mr-2">2.1. Analytic Solution</span><a href="#21-analytic-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>식 (1)은 아래처럼 해석해가 구해진다.</p>\[{dC_A \over C_A} = -k_1 dt,\quad\int_{C_{A,0}}^{C_A} {dC_A \over C_A} = \int_{0}^{t} -k_1 dt\] \[C_A = C_{A,0}e^{-k_1 t} \qquad (2)\]<p>$C_{A,0}$는 t=0 일때의 초기농도를 의미한다.</p><p>Data는 시간(tdata)와 각 시간에 측정한 A물질의 농도(concentration)이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">time_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9184</span><span class="p">,</span> <span class="mf">9.0875</span><span class="p">,</span> <span class="mf">11.2485</span><span class="p">,</span> <span class="mf">17.5255</span><span class="p">,</span> <span class="mf">23.9993</span><span class="p">,</span> <span class="mf">27.7949</span><span class="p">,</span> <span class="mf">31.9783</span><span class="p">,</span> <span class="mf">35.2118</span><span class="p">,</span> <span class="mf">42.973</span><span class="p">,</span> <span class="mf">46.6555</span><span class="p">,</span> <span class="mf">50.3922</span><span class="p">,</span> <span class="mf">55.4747</span><span class="p">,</span> <span class="mf">61.827</span><span class="p">,</span> <span class="mf">65.6603</span><span class="p">,</span> <span class="mf">70.0939</span><span class="p">])</span>

<span class="n">CA_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.906</span><span class="p">,</span> <span class="mf">0.8739</span><span class="p">,</span> <span class="mf">0.5622</span><span class="p">,</span> <span class="mf">0.5156</span><span class="p">,</span> <span class="mf">0.3718</span><span class="p">,</span> <span class="mf">0.2702</span><span class="p">,</span> <span class="mf">0.2238</span><span class="p">,</span> <span class="mf">0.1761</span><span class="p">,</span> <span class="mf">0.1495</span><span class="p">,</span> <span class="mf">0.1029</span><span class="p">,</span> <span class="mf">0.086</span><span class="p">,</span> <span class="mf">0.0697</span><span class="p">,</span> <span class="mf">0.0546</span><span class="p">,</span> <span class="mf">0.0393</span><span class="p">,</span> <span class="mf">0.0324</span><span class="p">,</span> <span class="mf">0.026</span><span class="p">])</span>
</pre></table></code></div></div><p>Data를 보니 $C_{A,0}$는 0.906이다. input은 time_data이고 output은 conc_data이니 간단한 nonlinear regression 문제로 바뀌었다. 아래 코드로 $k_1$을 구할 수 있다. (구글에 <code class="language-plaintext highlighter-rouge">python nonlinear regression</code> 검색해보자.)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>


<span class="n">time_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9184</span><span class="p">,</span> <span class="mf">9.0875</span><span class="p">,</span> <span class="mf">11.2485</span><span class="p">,</span> <span class="mf">17.5255</span><span class="p">,</span> <span class="mf">23.9993</span><span class="p">,</span> <span class="mf">27.7949</span><span class="p">,</span> <span class="mf">31.9783</span><span class="p">,</span> <span class="mf">35.2118</span><span class="p">,</span> <span class="mf">42.973</span><span class="p">,</span> <span class="mf">46.6555</span><span class="p">,</span> <span class="mf">50.3922</span><span class="p">,</span> <span class="mf">55.4747</span><span class="p">,</span> <span class="mf">61.827</span><span class="p">,</span> <span class="mf">65.6603</span><span class="p">,</span> <span class="mf">70.0939</span><span class="p">])</span>
<span class="n">CA_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.906</span><span class="p">,</span> <span class="mf">0.8739</span><span class="p">,</span> <span class="mf">0.5622</span><span class="p">,</span> <span class="mf">0.5156</span><span class="p">,</span> <span class="mf">0.3718</span><span class="p">,</span> <span class="mf">0.2702</span><span class="p">,</span> <span class="mf">0.2238</span><span class="p">,</span> <span class="mf">0.1761</span><span class="p">,</span> <span class="mf">0.1495</span><span class="p">,</span> <span class="mf">0.1029</span><span class="p">,</span> <span class="mf">0.086</span><span class="p">,</span> <span class="mf">0.0697</span><span class="p">,</span> <span class="mf">0.0546</span><span class="p">,</span> <span class="mf">0.0393</span><span class="p">,</span> <span class="mf">0.0324</span><span class="p">,</span> <span class="mf">0.026</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">C_A</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k1</span><span class="p">):</span>
    <span class="n">C_A0</span> <span class="o">=</span> <span class="n">CA_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">C_A0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">para</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">C_A</span><span class="p">,</span> <span class="n">time_data</span><span class="p">,</span> <span class="n">CA_data</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"k1 = </span><span class="si">{</span><span class="n">para</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>k1 = [0.05078669]
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Regressed Results"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">C_A</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">para</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">CA_data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Time"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Concentraion of A"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_2_0.png" alt="png" data-proofer-ignore></p><p>scipy모듈의 curve_fit함수를 사용한 간단한 regression이다. k1은 0.05가 나왔다.</p><p>참고로 curve_fit은 squared error sum을 최소화 해야 할 오차함수로 쓰는 것으로 보인다. 자세한건 <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">Documentation</a>을 읽어보자.</p><h3 id="22-numerical-solution"><span class="mr-2">2.2. Numerical Solution</span><a href="#22-numerical-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이번에는 수치적으로 식(1)을 풀어보자. 아래 코드로 구할 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>


<span class="n">time_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9184</span><span class="p">,</span> <span class="mf">9.0875</span><span class="p">,</span> <span class="mf">11.2485</span><span class="p">,</span> <span class="mf">17.5255</span><span class="p">,</span> <span class="mf">23.9993</span><span class="p">,</span> <span class="mf">27.7949</span><span class="p">,</span> <span class="mf">31.9783</span><span class="p">,</span> <span class="mf">35.2118</span><span class="p">,</span> <span class="mf">42.973</span><span class="p">,</span> <span class="mf">46.6555</span><span class="p">,</span> <span class="mf">50.3922</span><span class="p">,</span> <span class="mf">55.4747</span><span class="p">,</span> <span class="mf">61.827</span><span class="p">,</span> <span class="mf">65.6603</span><span class="p">,</span> <span class="mf">70.0939</span><span class="p">])</span>
<span class="n">CA_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.906</span><span class="p">,</span> <span class="mf">0.8739</span><span class="p">,</span> <span class="mf">0.5622</span><span class="p">,</span> <span class="mf">0.5156</span><span class="p">,</span> <span class="mf">0.3718</span><span class="p">,</span> <span class="mf">0.2702</span><span class="p">,</span> <span class="mf">0.2238</span><span class="p">,</span> <span class="mf">0.1761</span><span class="p">,</span> <span class="mf">0.1495</span><span class="p">,</span> <span class="mf">0.1029</span><span class="p">,</span> <span class="mf">0.086</span><span class="p">,</span> <span class="mf">0.0697</span><span class="p">,</span> <span class="mf">0.0546</span><span class="p">,</span> <span class="mf">0.0393</span><span class="p">,</span> <span class="mf">0.0324</span><span class="p">,</span> <span class="mf">0.026</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> 
    <span class="n">C_A</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">k</span>
    <span class="n">dCAdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dCAdt</span>


<span class="k">def</span> <span class="nf">Conc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">param</span><span class="p">):</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="n">CA_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">CA</span>


<span class="k">def</span> <span class="nf">f_resid</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_data</span><span class="p">)):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="p">(</span><span class="n">Conc</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">p</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">CA_data</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">guess</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f_resid</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"parameter values are "</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>parameter values are  [0.05078668]
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Regressed Results"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">Conc</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">CA_data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Time"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Concentraion of A"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_2_1.png" alt="png" data-proofer-ignore></p><p>조금 더 복잡해 보인다. 먼저 강조하고 싶은 건 내 머리속에서 처음부터 끝까지 나온 코드가 절대 아니다. <a href="https://stackoverflow.com/questions/11278836/fitting-data-to-system-of-odes-using-python-via-scipy-numpy">이 문서</a>를 참고했다. 그림 끼워맞추기 처럼 생각해도 좋다. 위 코드를 재사용하려면 이 코드의 이 부분이 어떤 역할을 하는지 눈치껏 보고 내 상황에 맞게 고치면 된다.</p><p>간단히 설명하자면 <code class="language-plaintext highlighter-rouge">f</code>함수는 식(1) 미분방정식 자체를 정의하고 <code class="language-plaintext highlighter-rouge">integrate.odeint</code>로 수치적분한 함수를 만들어 주고(식(2)에 해당할 것이다.) 수치적분한 함수와 데이터간의 오차를 <code class="language-plaintext highlighter-rouge">f_resid</code>로 정의했다. 여기서 오차는 오차제곱의 합으로 선정했다. 이후 <code class="language-plaintext highlighter-rouge">optimize.minimize</code>로 오차 함수를 최소화 하는 $k_1$을 구하도록 했고 결과는 똑같이 0.05가 나왔다.</p><p>두가지 방식 중 어떤 방식이 더 좋다고 할 수 있을까. 그보다 어느게 좋은 방식인지 말하는 기준은 뭘까.</p><h3 id="23-analytic-vs-numerical"><span class="mr-2">2.3. Analytic vs Numerical</span><a href="#23-analytic-vs-numerical" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>해석해를 통해 미분방정식을 푸는 일은 일단 꽤나 직관적이다. 인과관계를 파악하기도 용이할 것이고 어딘가에서 실수가 있었다면 발견하고 고치기도 쉬울 것이다. 참고로 해석해를 구하는 건 프로그래밍으로도 가능하다. (Symbolic한 연산을 수행해주는 <a href="https://docs.sympy.org/latest/modules/solvers/ode.html"><code class="language-plaintext highlighter-rouge">sympy</code> 라이브러리</a>가 있다.) 하지만 해석해가 존재하지 않는 미분방정식 또한 존재한다. 따라서 해석해를 구하는 방식은 일반적으로 모든 경우에 적용가능한 방법은 아니다.</p><p>수치적인 방법은 복잡한 미분방정식 풀이에 적당할 수 있다. 그렇다고 Euler Method같은 미분방정식 풀이 알고리즘을 꼭 알아야 할 필요는 없다. 라이브러리와 Solver들이 잘 갖추어져 있어 그냥 갖다쓰면 된다. 하지만 미분방정식 중에도 풀기 어려운 형태의 식들이 있다. <a href="https://en.wikipedia.org/wiki/Stiff_equation">Stiffness</a>같은 수치해석적인 이슈가 있는 경우도 있다. 물론 그런것들을 해결해주는 라이브러리 또한 Python 어딘가에 존재할 것이다.</p><p>둘 중 뭐가 더 좋다고 말할 수는 없다. 개인적으로는 쉬운 문제인 경우 직접 해석적으로 풀어보고 복잡한 문제라면 어쩔수 없이 수치적인 방법을 쓰는게 좋다고 생각한다. 근데 일단 미분방정식을 풀이할 일 자체가 인생에서 그리 많지는 않다..</p><h2 id="3-application"><span class="mr-2">3. Application</span><a href="#3-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>훨씬 복잡한 미분방정식 풀이를 해보려고 한다. 당연하게 Numerical method 쓴다. 6개의 물질(A~E)이 포함된 아래 반응에 대한 반응속도 문제를 예제로 삼아보자.</p>\[A + B \rightarrow C + D\] \[A + C \rightarrow E\]<p>반응속도식은 아래와 같이 주어진다고 가정하자.</p>\[{dC_A \over dt} = -k_1 C_A^2C_B - k_2C_AC_C \qquad (3.1)\] \[{dC_B \over dt} = -k_1 C_A^2C_B \qquad (3.2)\] \[{dC_C \over dt} = k_1 C_A^2C_B - k_2C_AC_C \qquad (3.3)\] \[{dC_D \over dt} = k_1 C_A^2C_B \qquad (3.4)\] \[{dC_E \over dt} = k_2C_AC_C \qquad (3.5)\]<p>식 (3.1) ~ (3.4)에서 $C_A$의 반응차수가 1이 아니라 2라는 것에 주의하자. 이번에는 미분방정식 5개인 ODEs System을 풀면서 동시에 Data에 맞는 $k_1$과 $k_2$를 fitting 해야 한다.</p><p>Intro에서 보여줬던 numerical solution 코드를 약간 수정하여 적용하면 아래처럼 된다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">time_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span><span class="o">/</span><span class="mi">60</span>

<span class="n">CAdata</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="o">~~~</span><span class="p">])</span>
<span class="n">CBdata</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="o">~~~</span><span class="p">])</span>
<span class="n">CCdata</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="o">~~~</span><span class="p">])</span>
<span class="n">CDdata</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="o">~~~</span><span class="p">])</span>
<span class="n">CEdata</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="o">~~~</span><span class="p">])</span>

<span class="n">Data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">CAdata</span><span class="p">,</span> <span class="n">CBdata</span><span class="p">,</span> <span class="n">CCdata</span><span class="p">,</span> <span class="n">CDdata</span><span class="p">,</span> <span class="n">CEdata</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> 
    <span class="n">C_A</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">C_B</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">C_C</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">C_D</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">C_E</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">k1</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">dCAdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span> <span class="o">-</span> <span class="n">k2</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_C</span><span class="p">)</span>
    <span class="n">dCBdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span>
    <span class="n">dCCdt</span> <span class="o">=</span> <span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span> <span class="o">-</span> <span class="n">k2</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_C</span><span class="p">)</span>
    <span class="n">dCDdt</span> <span class="o">=</span> <span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span>
    <span class="n">dCEdt</span> <span class="o">=</span> <span class="n">k2</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_C</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">dCAdt</span><span class="p">,</span> <span class="n">dCBdt</span><span class="p">,</span> <span class="n">dCCdt</span><span class="p">,</span> <span class="n">dCDdt</span><span class="p">,</span> <span class="n">dCEdt</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">Conc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">param</span><span class="p">):</span>

    <span class="n">f2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="n">CA</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">CB</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">CC</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">CD</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">CE</span> <span class="o">=</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">CA</span><span class="p">,</span> <span class="n">CB</span><span class="p">,</span> <span class="n">CC</span><span class="p">,</span> <span class="n">CD</span><span class="p">,</span> <span class="n">CE</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">f_resid</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    
    <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">Data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="p">((</span><span class="n">Data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">Conc</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">p</span><span class="p">)[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">]</span> 

<span class="n">y0</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> 

<span class="n">c</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f_resid</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"parameter values are "</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>parameter values are  [ 0.14028538 -0.02505139]
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="s">'CA'</span><span class="p">,</span> <span class="s">'CB'</span><span class="p">,</span> <span class="s">'CC'</span><span class="p">,</span> <span class="s">'CD'</span><span class="p">,</span> <span class="s">'CE'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Data</span><span class="p">)):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">Data</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">legend</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">Conc</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="p">)[</span><span class="n">i</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Time"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Conc"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">Data</span><span class="p">[</span><span class="mi">4</span><span class="p">,:])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">Conc</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">x</span><span class="p">)[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"CE Plot"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"MSE = </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_3_0.png" alt="png" data-proofer-ignore></p><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_3_1.png" alt="png" data-proofer-ignore></p><p>앞에서와 마찬가지로 <code class="language-plaintext highlighter-rouge">f</code>는 미분식을, <code class="language-plaintext highlighter-rouge">Conc</code>는 수치적분된 함수를, <code class="language-plaintext highlighter-rouge">f_resid</code>는 최소화 해야할 오차함수를 나타낸다. <code class="language-plaintext highlighter-rouge">f_resid</code>에서 return 해주는 <code class="language-plaintext highlighter-rouge">res</code>를 보면 단순한 오차의 제곱합임을 알 수 있다.</p><p><code class="language-plaintext highlighter-rouge">optimize.minimize</code> 함수로 <code class="language-plaintext highlighter-rouge">f_resid</code>를 최소화하는 $k_1$, $k_2$를 구해보면 각각 0.14, -0.025가 나온다. 물리적으로 두 속도상수는 양수가 나와야 한다. E농도 그래프의 경우 음수영역에서 움직인다. 수학적으로는 오차함수를 최소화하는 두 계수를 구했지만 물리적으로 맞지않는다. 생각보다 흔하게 발생하는 일이다.</p><h3 id="31-constraint-for-parameter"><span class="mr-2">3.1. Constraint for Parameter</span><a href="#31-constraint-for-parameter" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이런 경우에는 사용한 solver인 <code class="language-plaintext highlighter-rouge">optimize.minimize</code>에서 $k_1$, $k_2$의 범위를 정해주는 기능이 있는 경우 사용해주면 된다. 아니면 아래처럼 간단한 트릭을 사용해 줄 수도 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> 
    <span class="n">C_A</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">C_B</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">C_C</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">C_D</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">C_E</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="n">k1</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">dCAdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span> <span class="o">-</span> <span class="p">(</span><span class="n">k2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_C</span><span class="p">)</span>
    <span class="n">dCBdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span>
    <span class="n">dCCdt</span> <span class="o">=</span> <span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span> <span class="o">-</span> <span class="p">(</span><span class="n">k2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_C</span><span class="p">)</span>
    <span class="n">dCDdt</span> <span class="o">=</span> <span class="n">k1</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">C_B</span>
    <span class="n">dCEdt</span> <span class="o">=</span> <span class="p">(</span><span class="n">k2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_A</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C_C</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">dCAdt</span><span class="p">,</span> <span class="n">dCBdt</span><span class="p">,</span> <span class="n">dCCdt</span><span class="p">,</span> <span class="n">dCDdt</span><span class="p">,</span> <span class="n">dCEdt</span><span class="p">]</span>
</pre></table></code></div></div><p>애초에 식을 정의할 때 $k_2$에 제곱을 해준다. 이러면 $k_2$로 무슨 값이 나오든 식에 적용할 때에는 양수가 된다. 이런 방법을 잘 활용하면 exponential로 정의해서 양수가 되게 한다거나 $1/(1+x^2)$ 같이 0과 1사이가 되게 한다거나 하는 것도 생각 할 수 있다. 어차피 식이 복잡해져도 계산은 컴퓨터가 해줄 것이다.</p><p>Fitting 결과는 다음과 같다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>parameter values are  [ 1.4959010e-01 -8.4175129e-08]
</pre></table></code></div></div><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_3_2.png" alt="png" data-proofer-ignore></p><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_3_3.png" alt="png" data-proofer-ignore></p><p>$k_2$ 결과값은 -0.00000008로 제곱하면 거의 0이다. 자연스럽게 시간에 따른 E의 농도는 0이될 것이다. 애초에 음수가 아니면 0이 나올 상황이었던 것 같다.</p><h3 id="32-absolute-error-vs-relative-error"><span class="mr-2">3.2. Absolute Error vs Relative Error</span><a href="#32-absolute-error-vs-relative-error" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>A~D물질의 경우 나타나지 않는 현상이 E에서만 유독 나타나는 이유는 뭘까. 실험데이터가 틀렸을 수 있고 반응속도식 (3.1) ~ (3.5)가 틀렸을 수 있고 또 하나는 데이터 scale의 문제일 수도 있다.</p><p>일종의 Cost 함수인 <code class="language-plaintext highlighter-rouge">f_resid</code>는 오차제곱합, squared error sum이고 아래 식으로 표현된다.</p>\[Cost = \sum_i^m(y_i-f(x_i))^2 \qquad (4)\]<p>$y$는 Data, $f(x_i)$는 계산값이다. Data를 잘 보면 A~D 물질들의 시간에 따른 농도 데이터는 대부분 1보다 크다. 하지만 E물질의 경우 농도 데이터는 커봐야 0.1이다. 식(4)로 동일하게 Cost를 적용할 경우 아무래도 값이 큰 A~D에 더 잘 맞도록 $k_1$, $k_2$를 움직일 것이다.</p><p>다시 말하면 Data의 Scale이 다른 것이고 이게 심할때는 일종의 왜곡이 일어나게 된다. 이런 경우 아래와 같이 <a href="https://www.scienceall.com/%EC%83%81%EB%8C%80%EC%98%A4%EC%B0%A8relative-error-2/">상대오차</a>, relative error를 Cost로 사용해 볼 수 있다.</p>\[Cost = \sum_i^m \left({y_i - f(x_i) \over y_i}\right)^2 \qquad (5)\]<p>위 식에는 오차의 분모부분에 다시한번 data를 넣어주어서 작은 값을 가지는 data에는 잘 맞도록 충분한 가중치를 주고 반대로 큰 값을 가지는 data에는 penalty를 주는 느낌이다.</p><p><code class="language-plaintext highlighter-rouge">f_resid</code>를 수정하고 돌려보면 결과는 다음과 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f_resid</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    
    <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">Data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">+</span> <span class="p">((</span><span class="n">Data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">Conc</span><span class="p">(</span><span class="n">time_data</span><span class="p">,</span> <span class="n">p</span><span class="p">)[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">Data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>parameter values are  [0.10749438 0.11924306]
</pre></table></code></div></div><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_3_5.png" alt="png" data-proofer-ignore></p><p><img data-src="https://raw.github.com/ch-hey/imgcdn/master/img/2022-08-22/output_3_6.png" alt="png" data-proofer-ignore></p><p>결과는 훨씬 좋다. $k_1$, $k_2$도 물리적으로 말이 되고 E물질 농도에 대해 경향성을 놓치지 않으면서 다른 data에도 적당한 fit을 보여준다. 최종 식(3)에 사용하게 될 속도 상수는 아래처럼 주어진다.</p>\[k_1 = 0.1075, \quad k_2 = 0.0142\]<p>Scipy.optimize를 반드시 써야 하는건 아니다. Multiple ODE regression은 다른 예제도 있고 symfit이라는 라이브러리의 경우 조금 더 직관적으로 이해가 되게끔 구성이 되있기도 하다. <a href="https://symfit.readthedocs.io/en/stable/examples/ex_ode_system.html">이 예제</a>도 충분히 활용해 볼 만 하다. 어쩌면 끔찍할거같지만 엑셀로도 가능할지 모른다.</p><p>편한만큼 자유도가 떨어지기도 한다. 반대로 자유도가 높으면 할 수 있는건 많아지지만 신경쓸것도 많아진다.</p><p>머리가 고생하면 몸이 편하지만, 몸이 고생하면 머리가 편하다.</p><h2 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>공학용 계산 첫번째 시간으로 미분방정식 풀이와 fitting까지 해봤다. 해석해를 구해서 단순 regression만 해보기도 했고 numerical하게 계산해서 오차함수를 정의한 다음에 이를 최소화 하는 함수를 사용하기도 했다.</p><p>반응속도식을 세우고 상수를 구한다는게 개별 반응의 특성마다 상황이 굉장히 다르고 수식을 세우기 나름인 부분도 커서 일반적인 해결방법에 대한 얘기를 하지는 못한다. 이런 얘기를 하려면 반응공학 수업을 통째로 들어야 하고 작성자 본인도 잘 모른다.</p><p>이 포스팅에서는 미분방정식이 세워졌을 때 어떤 식으로 문제를 해결할 수 있는지 Python으로 보여주는걸 목표로 잡았고 그 예제로 반응속도식을 선정한 것 뿐이다. 하지만 애써 수식들이 세워졌더라도 fitting 하는 데에 신경써야 할 부분들이 적지 않음을 알 수 있다.</p><p>Python만이 이런 문제를 해결할 수 있는 건 아니지만 이만큼 또 편하게 시도해보고 답을 찾을 수 있는 프로그래밍 언어도 없다고 생각한다. 다음번 포스팅에는 여러가지 Regression과 방정식 풀이로 예제를 가져올 생각이다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/engineering-calculation/'>Engineering Calculation</a>, <a href='/categories/ode-kinetics/'>ODE-Kinetics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/engineering-calculation/" class="post-tag no-text-decoration" >Engineering Calculation</a> <a href="/tags/python/" class="post-tag no-text-decoration" >Python</a> <a href="/tags/kinetics/" class="post-tag no-text-decoration" >Kinetics</a> <a href="/tags/differential-equation/" class="post-tag no-text-decoration" >Differential Equation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5BEng.+Calc.%5D+Differential+Equations+-+Kinetics+-+ChBlog&url=https%3A%2F%2Fch-hey.github.io%2Fposts%2FEngineering-Calculation%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5BEng.+Calc.%5D+Differential+Equations+-+Kinetics+-+ChBlog&u=https%3A%2F%2Fch-hey.github.io%2Fposts%2FEngineering-Calculation%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fch-hey.github.io%2Fposts%2FEngineering-Calculation%2F&text=%5BEng.+Calc.%5D+Differential+Equations+-+Kinetics+-+ChBlog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/venv-Python-32bit/">[Python] Virtual Env(venv)로 가상환경 만들기</a><li><a href="/posts/AI-Tensorflow/">[머신러닝] Tensorflow</a><li><a href="/posts/Neural-Network/">[머신러닝] 인공신경망 Artificial Neural Network</a><li><a href="/posts/Engineering-Calculation/">[Eng. Calc.] Differential Equations - Kinetics</a><li><a href="/posts/Orientation/">Orientation</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/engineering-calculation/">Engineering Calculation</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/andrew-ng/">Andrew NG</a> <a class="post-tag" href="/tags/aspen-plus/">Aspen Plus</a> <a class="post-tag" href="/tags/com-object/">COM Object</a> <a class="post-tag" href="/tags/coursera/">Coursera</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Engineering-Calculation2/"><div class="card-body"> <em class="small" data-ts="1662378900" data-df="ll" > Sep 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Eng. Calc.] Regression and Curve-Fit</h3><div class="text-muted small"><p> 이번 공학용 계산 주제는 Regression 이다. 편의상 Fitting 이라고도 한다. Regression, Fitting 원래는 명확한 구분이 있을거 같으면서도 굉장히 혼용되서 사용되는 단어 같다. 실은 딱히 명확한 구분은 없는 것 같다. 관련해선 이 문서를 한 번 읽어보자. 여기서는 변수, independent variable $x$에 대해서 ...</p></div></div></a></div><div class="card"> <a href="/posts/Engineering-Calculation3/"><div class="card-body"> <em class="small" data-ts="1663502100" data-df="ll" > Sep 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Eng. Calc.] Nonlinear Equations Solving</h3><div class="text-muted small"><p> 이번 공학용계산 포스팅의 주제는 Equation Solving, 방정식 풀이다. 선형방정식에 대한 풀이는 손으로도 쉽게 풀리기 때문에 여기서는 비선형방정식에 대한 풀이를 다뤄본다. 복잡한 수치해석적인 방법에 대한 소개는 없다. Python으로 어떻게 비선형방정식을 푸는지, 어떤 모듈이 필요한지 계산 예시를 통해 소개한다. 화학공학에서 종종 만나게 ...</p></div></div></a></div><div class="card"> <a href="/posts/Engineering-Calculation4/"><div class="card-body"> <em class="small" data-ts="1666007700" data-df="ll" > Oct 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Eng. Calc.] Symbolic Computation</h3><div class="text-muted small"><p> 이번 공학용계산 포스팅의 주제는 Symbolic Computation, 기호 계산(?)이다. 개인적으로는 보통 그냥 심볼릭한 계산이라고 부른다. Symbolic Calculation이라고 검색해보려 했는데 구글에서 자동완성으로 Computation을 추천한다. 고민없이 Computation을 쓰자. Symbolic한 계산이란 것은 인간이 수행하는 문...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Neural-Network/" class="btn btn-outline-primary" prompt="Older"><p>[머신러닝] 인공신경망 Artificial Neural Network</p></a> <a href="/posts/Engineering-Calculation2/" class="btn btn-outline-primary" prompt="Newer"><p>[Eng. Calc.] Regression and Curve-Fit</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ch-hey">HEY</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/engineering-calculation/">Engineering Calculation</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/andrew-ng/">Andrew NG</a> <a class="post-tag" href="/tags/aspen-plus/">Aspen Plus</a> <a class="post-tag" href="/tags/com-object/">COM Object</a> <a class="post-tag" href="/tags/coursera/">Coursera</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
